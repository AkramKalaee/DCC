We propose to directly learn the discrete codes in anend-to-end neural network by applying the Gumbel-softmax trick.