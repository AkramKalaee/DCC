We explain efficient inferenceprocedures that allow application to both parsing and language modeling.Experiments show that they provide better parsing in English than any singlepreviously published supervised generative model and better language modelingthan state-of-the-art sequential RNNs in English and Chinese.