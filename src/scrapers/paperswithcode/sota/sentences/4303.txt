The whole model is unsupervised, and is trained in an end-to-end manner with gradient descent methods.