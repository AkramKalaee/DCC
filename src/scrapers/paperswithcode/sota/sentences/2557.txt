This is ensured by using a sequential pair-wise discriminator that shares weights with the encoder that is trained with a suitable loss function.