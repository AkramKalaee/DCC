The whole model is unsupervised, and is trained in an end-to-endmanner with gradient descent methods.