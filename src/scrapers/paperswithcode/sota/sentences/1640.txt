The controller is trained with policy gradient to select a subgraph that maximizes the expected reward on the validation set.