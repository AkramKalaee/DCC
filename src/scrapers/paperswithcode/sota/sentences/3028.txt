We show its effectiveness for the set reasoning task ofcorrespondence classification as well as for image restoration, including imagedenoising and single image super-resolution, where we outperform strongconvolutional neural network (CNN) baselines and recent non-local models thatrely on KNN selection in hand-chosen features spaces.