The RPN is trained end-to-end to generate high-quality region proposals, which are used by Fast R-CNN for detection.