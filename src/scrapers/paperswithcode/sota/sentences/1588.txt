We propose to directly learn the discrete codes in an
end-to-end neural network by applying the Gumbel-softmax trick.