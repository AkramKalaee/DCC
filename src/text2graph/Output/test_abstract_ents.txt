b'Method' b'k-nearest neighbors (knn) matching in a \xef\xac\x81xed feature space. the main hurdle in optimizing this feature space w. r. t. application performance is the non-differentiability of the knn selection rule. to overcome this, we propose a continuous deterministic relaxation of knn selection that maintains differentiability w. r. t. pairwise distances, but retains the original knn as the limit of a temperature parameter approaching zero. to exploit our relaxation, we propose the neural nearest neighbors block (n3 block), a novel non-local processing layer that leverages the principle of self-similarity and can be used as building block in modern neural network architectures.1 we show its effectiveness for the set reasoning task of correspondence classi\xef\xac\x81cation as well as for image restoration, including image denoising and single image super-resolution, where we outperform strong convolutional neural network (cnn) baselines and recent non-local models that rely on knn selection in hand-chosen features spaces.  1' 177 1192
